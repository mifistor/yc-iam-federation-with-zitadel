
# Terraform модуль `usersgen` 

## Оглавление
* [Описание модуля](#ug-overview)
* [Входные параметры модуля](#ug-inputs)
* [Выходные параметры модуля](#ug-outputs)
* [Управление пользователями](#ug-operations)


## Описание модуля <a id="ug-overview"/></a>

Модуль [usersgen](../usersgen/) является вспомогательным для модуля [zitadel-config](../zitadel-config/README.md) из которого и вызывается. С помощью данного модуля осуществляется управление обычными пользователями *(не менеджерами)* в организации Zitadel.

## Входные параметры модуля <a id="ug-inputs"/></a>

| Параметр (переменная) | Описание |
| - | -
| `zitadel_users` | Полный путь к YAML-файлу с описанием пользователей. Например, может быть определён так - `"${abspath(path.module)}/users.yml"`, что означает, взять из папки где запускается модуль файл `users.yml`. Формат описания пользователей см. в разделе ["Управление пользователями"](#ug-operations). |


## Выходные параметры модуля <a id="ug-outputs"/></a>

Формально выходных параметров у модуля нет (он ничего не возвращает), однако в процессе своей работы он генерирует terraform код, который записывается в файл с определённым именем по определенному пути. Значения имени и пути определяются в коде модуля в переменной [users_out](./usersgen.tf). По умолчанию это значение равно `../../zitadel-config/users.tf`, но может быть изменено при необходимости.

## Управление пользователями <a id="ug-operations"/></a>

Под `управлением пользователями` понимаются следующие действия:
* добавление нового пользователя в Zitadel организацию.
* удаление существующего пользователя из Zitadel организации.
* изменение атрибутов у существующего в организации пользователя.

Управление пользователями осуществляется с помощью специального файла в формате YAML с описанием пользователей и их атрибутов. Каждая запись в этом файле описывает одного пользователя. В файле может быть одна или несколько записей.

Пример записи с описанием атрибутов для одного пользователя приведён ниже:

```yml
zuser1:
  fname: "First"
  lname: "Firstov"
  lang: "en"
  email: "first@myorg.org"
  pass: "Th3mVxPz5#mIDXlL7P"
```

где,

* `zuser1` - идентификатор пользователя
* `fname` - имя пользователя (First Name)
* `lname` - фамилия пользователя (Last Name)
* `lang` - язык интерфейса по-умолчанию для пользователя в Zitadel
* `pass` - пароль учетной записи пользователя

Примечание:
При аутентификация пользователь должен будет ввести свой идентификатор `zuser1` и пароль.
